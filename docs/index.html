<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobiliteit Gent Trekt Op Niets - De Klachtenmuur</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Maps API Script -->
    <!-- Note: We use the 'initMap' callback. A valid API key is required for production use, but is omitted here for the sandbox environment. -->
    <script async src="https://maps.googleapis.com/maps/api/js?callback=initMap"></script>
    <style>
        /* Custom styles for the high-contrast, urgent theme */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a; /* Deep black background */
            color: #ffffff;
            min-height: 100vh;
        }

        /* Hero Text Style - Large, impactful */
        .hero-title {
            text-shadow: 0 0 10px rgba(255, 255, 0, 0.5); /* Subtle yellow neon glow */
        }

        /* Warning Yellow Accent Button */
        .warning-button {
            background-color: #fde047; /* Tailwind yellow-300 */
            color: #1f2937; /* Dark text for contrast */
            transition: background-color 0.2s, transform 0.1s;
        }

        .warning-button:hover {
            background-color: #facc15; /* Tailwind yellow-400 */
            transform: scale(1.02);
        }

        /* Complaint Card Style */
        .complaint-card {
            background-color: #1f2937; /* Dark slate background */
            border: 1px solid #4b5563; /* Subtle border */
            transition: box-shadow 0.3s;
        }

        .complaint-card:hover {
            box-shadow: 0 0 15px rgba(253, 224, 71, 0.4); /* Yellow glow on hover */
        }

        /* Icon Styling */
        .icon-warning {
            color: #ef4444; /* Red color for danger */
        }

        /* Spinner style */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fde047; /* Yellow spinner */
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Map Container Styling */
        #map {
            height: 500px; /* Fixed height for good visibility */
            width: 100%;
            margin-bottom: 4rem;
            border-radius: 0.75rem; /* rounded-xl equivalent */
            border: 2px solid #fde047; /* Yellow border */
        }
        
        /* Custom Infobox/Modal for adding a location (Google Maps InfoWindow content) */
        .map-infobox {
            background-color: #1f2937;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            max-width: 300px;
        }
        .map-infobox h3 {
            color: #fde047;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .map-infobox textarea {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background-color: #0a0a0a;
            color: white;
            border: 1px solid #4b5563;
            border-radius: 0.25rem;
        }
    </style>
</head>
<body>

<div id="app" class="w-full min-h-screen">
    
    <!-- Header/Navigation (Simplified) -->
    <header class="bg-black border-b border-gray-700 p-4 sticky top-0 z-10">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <h2 class="text-xl font-extrabold text-yellow-400">
                GENT_MOBILITEIT_FAIL
            </h2>
            <button class="text-sm font-semibold text-gray-400 hover:text-yellow-400 transition duration-150">
                Meld Een Situatie
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-6xl mx-auto p-6 md:p-12">
        
        <!-- Hero Section: The Main Statement -->
        <section class="text-center mb-16 pt-8 pb-4">
            <h1 class="hero-title text-5xl sm:text-7xl font-extrabold mb-4 uppercase leading-tight">
                MOBILITEIT GENT<br class="sm:hidden"> TREKT OP NIETS.
            </h1>
            <p class="text-lg text-gray-400 max-w-3xl mx-auto">
                De Ã©chte frustraties die het verkeer in Gent dagelijks gevaarlijk maken, worden genegeerd. Tijd voor een muur van klachten.
            </p>
        </section>

        <!-- New: Interactive Map Section -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-yellow-400 mb-6 text-center">DE GEVAARZONES VAN GENT</h2>
            <p class="text-gray-400 mb-6 text-center">
                Klik op de kaart om een locatie aan te duiden waar mobiliteitsproblemen gevaarlijke situaties veroorzaken.
            </p>
            <div id="map"></div>
        </section>

        <!-- Specific Complaint Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">

            <!-- Complaint 1: Corner Parking & Reversing Danger -->
            <div class="complaint-card p-6 sm:p-8 rounded-xl">
                <div class="flex items-center mb-4">
                    <!-- Danger Icon: Exclamation Triangle -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 icon-warning mr-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                        <line x1="12" y1="9" x2="12" y2="13"></line>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <h2 class="text-2xl font-bold text-red-500 uppercase">Dodelijke Hoekparkeerders</h2>
                </div>
                <p class="text-gray-300 mb-6">
                    Mensen die "snel even" parkeren op straathoeken, fietspaden of vlak voor opritten om een boodschap te doen.
                </p>
                <div class="space-y-4 border-l-4 border-yellow-400 pl-4 py-2">
                    <p class="text-yellow-400 font-semibold">Gevolg:</p>
                    <ul class="text-gray-400 space-y-2 text-sm">
                        <li><strong>Blokkade:</strong> Verkeer in de straat kan niet draaien en moet wachten.</li>
                        <li><strong>Achteruitrijden:</strong> Bestuurders moeten achterwaarts de hoofdbaan op, wat fietsers en voetgangers in direct gevaar brengt.</li>
                        <li><strong>Onveiligheid:</strong> Fietsers en wandelaars moeten uitwijken naar de rijbaan zonder zicht.</li>
                    </ul>
                </div>
            </div>

            <!-- Complaint 2: Excessive Speed in 30 Zones -->
            <div class="complaint-card p-6 sm:p-8 rounded-xl">
                <div class="flex items-center mb-4">
                    <!-- Speed/Gauge Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 icon-warning mr-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 16 12 12 16 12"></polyline>
                        <line x1="12" y1="12" x2="12" y2="8"></line>
                    </svg>
                    <h2 class="text-2xl font-bold text-red-500 uppercase">De '30 Is Te Traag' Piloten</h2>
                </div>
                <p class="text-gray-300 mb-6">
                    Zone 30 km/h is bedoeld voor veiligheid in woonwijken, niet als snelkoppeling om de ring te vermijden.
                </p>
                <div class="space-y-4 border-l-4 border-yellow-400 pl-4 py-2">
                    <p class="text-yellow-400 font-semibold">De Feiten:</p>
                    <ul class="text-gray-400 space-y-2 text-sm">
                        <li><strong>Impact:</strong> De overlevingskans van een fietser daalt dramatisch bij snelheden boven 30 km/h.</li>
                        <li><strong>Geluidsoverlast:</strong> Onnodig lawaai en agressie in rustige, dichtbevolkte straten.</li>
                        <li><strong>Overtredingen:</strong> Constant 50 km/h of meer in zones waar kinderen spelen.</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Call to Action / Interactive Feedback -->
        <section class="mt-16 text-center bg-gray-800 p-8 sm:p-12 rounded-xl border-2 border-yellow-400/50">
            <h2 class="text-3xl font-bold mb-4 text-yellow-400">VOEL JIJ DE FRUSTRATIE OOK?</h2>
            <p class="text-gray-300 mb-6 max-w-2xl mx-auto">
                Deel de situatie die jou het meest stoort. Hoewel dit een simulatie is, dient het als een stem voor iedereen die dagelijks gevaar ervaart.
            </p>
            
            <textarea id="feedback-input" 
                      class="w-full max-w-xl p-4 bg-gray-700 text-white rounded-lg border-2 border-gray-600 focus:border-yellow-400 focus:ring-yellow-400 mb-4" 
                      rows="3" 
                      placeholder="Typ hier jouw #MobiliteitGentTrektOpNiets moment (bijv. straatnaam en tijdstip)..."></textarea>
            
            <!-- Simulated Submission Button || simulateSubmission() -->
            <button onclick="alert('deze website is nog in ontwikkeling')" class="warning-button font-extrabold py-3 px-8 rounded-full uppercase shadow-lg">
                Zend Klacht Nu In
            </button>

            <!-- Submission Message Box -->
            <div id="submission-message" class="mt-4 p-3 bg-red-800 text-white rounded-lg hidden max-w-xl mx-auto">
                Bedankt! Jouw klacht is genoteerd.
            </div>
        </section>

    </main>
</div>

<script>
    // Global map variables
    let map;
    let infowindow;
    
    // Mock data storage for initial markers (simulating DB loading)
    const dangerousLocations = [
        { lat: 51.0560, lng: 3.7250, description: "Door foutparkeren op de hoek van de Groentenmarkt is er geen zicht voor fietsers." },
        { lat: 51.0435, lng: 3.7380, description: "Regelmatig te hoge snelheid op de Einde Were. Zone 30 wordt genegeerd!" },
        { lat: 51.0505, lng: 3.7000, description: "Achteruitrijdende bestelwagens op de Kortrijksepoortstraat." }
    ];

    /**
     * Initializes the Google Map centered on Ghent and loads existing markers.
     */
    function initMap() {
        const gentCoords = { lat: 51.0500, lng: 3.7300 }; // Center of Ghent

        if (typeof google === 'undefined' || typeof google.maps === 'undefined') {
            console.error("Google Maps API is not loaded.");
            return;
        }

        map = new google.maps.Map(document.getElementById("map"), {
            center: gentCoords,
            zoom: 13,
            // Simple map ID, necessary for modern map rendering
            mapId: "DEMO_MAP_ID" 
        });

        infowindow = new google.maps.InfoWindow();

        // 1. Load existing records (Simulate DB retrieval)
        loadDangerousLocationsFromDB();

        // 2. Add click listener for new marker creation
        map.addListener("click", (mapsMouseEvent) => {
            const coords = mapsMouseEvent.latLng;
            showAddLocationForm(coords);
        });
    }

    /**
     * Simulates loading markers from a database and placing them on the map.
     */
    function loadDangerousLocationsFromDB() {
        dangerousLocations.forEach(location => {
            addMarkerToMap(location.lat, location.lng, location.description, false); // Existing markers
        });
    }
    
    /**
     * Shows the form (infowindow) to add a description for the clicked location.
     */
    function showAddLocationForm(coords) {
        if (!map) return;
        
        const contentString = `
            <div class="map-infobox">
                <h3>Voeg Gevaarlijke Locatie Toe</h3>
                <textarea id="marker-description" placeholder="Beschrijf de frustratie hier..."></textarea>
                <p class="text-xs text-gray-400 mb-2">Locatie: ${coords.lat().toFixed(4)}, ${coords.lng().toFixed(4)}</p>
                <button 
                    onclick="submitNewLocation(${coords.lat()}, ${coords.lng()})" 
                    class="warning-button w-full font-semibold py-2 px-4 rounded-md text-sm">
                    Verzenden
                </button>
            </div>
        `;

        infowindow.setContent(contentString);
        infowindow.setPosition(coords);
        infowindow.open(map);
    }

    /**
     * Adds a marker to the map and sets up its click listener.
     */
    function addMarkerToMap(lat, lng, description, isNew = false) {
        const coords = { lat: lat, lng: lng };
        
        const marker = new google.maps.Marker({
            position: coords,
            map,
            title: description.substring(0, 50) + "...",
            // Custom yellow flag icon for new submissions to make them stand out
            icon: isNew ? { 
                path: google.maps.SymbolPath.FLAG,
                fillColor: "#fde047", 
                fillOpacity: 1,
                strokeWeight: 0,
                scale: 6,
            } : null // Default icon for loaded (simulated DB) markers
        });

        marker.addListener("click", () => {
             infowindow.setContent(`
                <div class="map-infobox !bg-gray-800">
                    <h3 class="text-base text-red-400">Gevaarzone Gemeld</h3>
                    <p class="text-sm text-gray-300">${description}</p>
                </div>
            `);
            infowindow.open(map, marker);
        });
        
        if (isNew) {
            // Simulate saving new data to DB
            saveDangerousLocationToDB(lat, lng, description);
        }
    }

    /**
     * Simulates saving the new location to the backend/DB via API placeholder.
     */
    function saveDangerousLocationToDB(lat, lng, description) {
        const newLocation = { lat, lng, description, timestamp: Date.now() };
        console.log("MOCK API POST/PUT: Sending new location to backend:", newLocation);

        // --- API Placeholder: In a real app, you would use fetch() here ---
        /*
        fetch('/api/dangerous-locations', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(newLocation)
        });
        */
        
        // Show success message near the map
        const mapSection = document.querySelector('.mb-16');
        let messageBox = document.getElementById('map-submission-message');
        if (!messageBox) {
            messageBox = document.createElement('div');
            messageBox.id = 'map-submission-message';
            messageBox.classList.add('p-3', 'rounded-lg', 'max-w-lg', 'mx-auto', 'mt-4');
            mapSection.appendChild(messageBox);
        }

        messageBox.className = 'mt-4 p-3 bg-green-700 text-white rounded-lg max-w-lg mx-auto';
        messageBox.textContent = "Locatie succesvol gemeld! Bedankt om de gevaarzone aan te duiden.";
        
        // Remove message after a few seconds
        setTimeout(() => {
            if (messageBox.parentNode) messageBox.remove();
        }, 5000);
    }
    
    /**
     * Handles the form submission from the map infowindow.
     */
    window.submitNewLocation = function(lat, lng) {
        const descriptionInput = document.getElementById('marker-description');
        const description = descriptionInput ? descriptionInput.value.trim() : '';

        if (description) {
            infowindow.close();
            addMarkerToMap(lat, lng, description, true);
        } else {
            // Display an error in the infowindow if description is empty
            const contentString = `
                <div class="map-infobox bg-red-800">
                    <h3 class="text-red-300">Fout: Beschrijving Nodig</h3>
                    <p class="text-sm text-gray-100">Vul a.u.b. een korte beschrijving in van de gevaarlijke situatie.</p>
                </div>
            `;
            infowindow.setContent(contentString);
            infowindow.open(map);
        }
    }

    /**
     * Existing function for text feedback submission (kept separate)
     */
    function simulateSubmission() {
        const input = document.getElementById('feedback-input');
        const messageBox = document.getElementById('submission-message');

        if (input.value.trim() === "") {
            messageBox.textContent = "Voer eerst een situatie in, aub.";
            messageBox.classList.remove('hidden');
            messageBox.classList.add('bg-red-600');
            messageBox.classList.remove('bg-green-600');
            return;
        }

        console.log("Simulated Complaint Sent (Text Box):", input.value);
        
        messageBox.textContent = "Klacht verzonden. Jouw frustratie is gehoord!";
        messageBox.classList.remove('hidden');
        messageBox.classList.add('bg-green-600');
        messageBox.classList.remove('bg-red-600');
        
        input.value = ""; 

        setTimeout(() => {
            messageBox.classList.add('hidden');
        }, 5000);
    }
    
    // Expose functions globally for the Google Maps API callback and HTML onclick handlers
    window.initMap = initMap;
    window.simulateSubmission = simulateSubmission;

</script>

</body>
</html>
